<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>PvP EXTREME</title>
    <script src="https://unpkg.com/peerjs@1.5.1/dist/peerjs.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="main-container">
        <!-- 메인 메뉴 -->
        <div id="main-menu" class="screen">
            <h1>PvP<span style="font-size:20px; vertical-align:middle; color:cyan;">EXTREME</span></h1>
            <div class="btn" onclick="startGameMode('local')">친구와 하기 (로컬)</div>
            <div class="btn" onclick="openOnlineMenu()">온라인 대전 (멀티)</div>
            <div class="btn" onclick="openSettings()">키 설정</div>
        </div>

        <!-- 온라인 메뉴 -->
        <div id="online-menu" class="screen hidden">
            <h1>온라인 대전</h1>
            <div id="online-status" style="margin-bottom: 20px; color: cyan; font-weight: bold; font-size: 18px;">대기 중...</div>
            <div class="tab-menu">
                <div id="tab-create" class="tab-btn active" onclick="switchTab('create')">방 만들기</div>
                <div id="tab-join" class="tab-btn" onclick="switchTab('join')">방 들어가기</div>
            </div>
            <div id="panel-create">
                <div class="input-group">
                    <label>방 제목 (ID)</label>
                    <input type="text" id="create-room-id" placeholder="예: game1">
                </div>
                <div class="input-group">
                    <label>비밀번호 (선택)</label>
                    <input type="password" id="create-room-pw" placeholder="비워두면 공개방">
                </div>
                <div class="btn" onclick="createRoom()">방 생성 및 대기</div>
            </div>
            <div id="panel-join" class="hidden">
                <div class="input-group">
                    <label>참가할 방 제목 (ID)</label>
                    <input type="text" id="join-room-id" placeholder="친구의 방 제목 입력">
                </div>
                <div class="input-group">
                    <label>비밀번호</label>
                    <input type="password" id="join-room-pw" placeholder="비밀번호 (있다면)">
                </div>
                <div class="btn" id="btn-join-room" onclick="joinRoom()">참가하기</div>
            </div>
            <div class="btn" onclick="location.reload()" style="background: #7f8c8d; margin-top:20px;">뒤로 가기</div>
        </div>

        <!-- 호스트 대기 화면 -->
        <div id="host-wait-screen" class="screen hidden">
            <h1 id="host-room-name">방 제목</h1>
            <h2 style="color:lime">참가자 대기 중...</h2>
            <p>친구에게 방 제목과 비밀번호를 알려주세요.</p>
            <div class="btn" onclick="location.reload()" style="background: #c0392b;">방 없애기 (나가기)</div>
        </div>

        <!-- 키 설정 -->
        <div id="settings-screen" class="screen hidden">
            <h1>키 설정</h1>
            <div id="key-config-list"></div>
            <div class="btn" onclick="saveSettings()">저장</div>
            <div class="btn" onclick="resetSettings()" style="background:#c0392b">초기화</div>
        </div>

        <!-- 캐릭터 선택 -->
        <div id="char-select-screen" class="screen hidden">
            <h1 id="select-title">캐릭터 선택</h1>
            <div id="select-timer"></div>
            <div id="select-status"></div>
            <div class="char-grid" id="char-grid">
                <div class="char-card random" onclick="selectMyChar('random')">?</div>
            </div>
        </div>

        <!-- 맵 선택 -->
        <div id="map-select-screen" class="screen hidden">
            <h1>전장 선택</h1>
            <div class="map-grid" id="map-grid"></div>
        </div>

        <!-- 게임 HUD -->
        <div id="hud">
            <div class="p-stat">
                <div id="p1-name-display" class="p-name-tag" style="color:cyan;">PLAYER 1</div>
                <div class="hp-bar-bg">
                    <div id="p1-hp" class="hp-bar-fill" style="background: linear-gradient(90deg, #00c6ff, #0072ff);"></div>
                    <span class="hp-text" id="p1-hp-text">100</span>
                </div>
                <div class="cooldowns">
                    <span class="cd-box">E: <span id="p1-cd-e">READY</span></span>
                    <span class="cd-box">R: <span id="p1-cd-r">READY</span></span>
                    <span class="cd-box">S: <span id="p1-cd-s">READY</span></span>
                </div>
            </div>
            <div class="p-stat" style="text-align: right;">
                <div id="p2-name-display" class="p-name-tag" style="color:orange;">PLAYER 2</div>
                <div class="hp-bar-bg">
                    <div id="p2-hp" class="hp-bar-fill" style="background: linear-gradient(90deg, #f12711, #f5af19); float: right;"></div>
                    <span class="hp-text" id="p2-hp-text">100</span>
                </div>
                <div class="cooldowns" style="justify-content: flex-end;">
                    <span class="cd-box">E: <span id="p2-cd-e">READY</span></span>
                    <span class="cd-box">R: <span id="p2-cd-r">READY</span></span>
                    <span class="cd-box">S: <span id="p2-cd-s">READY</span></span>
                </div>
            </div>
        </div>

        <canvas id="gameCanvas" width="900" height="550"></canvas>

        <div id="overlay">
            <div id="overlay-text"></div>
            <div id="overlay-subtext"></div>
            <div style="display:flex; gap:20px;">
                <div class="btn" id="rematch-btn" style="display:none;" onclick="requestRematch()">다시 하기</div>
                <div class="btn" id="restart-btn" style="display:none;" onclick="quitToMainMenu()">메인 메뉴로</div>
            </div>
        </div>
    </div>

    <!-- 순서 중요! -->
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/classes.js"></script>
    <script src="js/network.js"></script>
    <script src="js/render.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/game.js"></script>
    <script src="js/main.js"></script>
</body>
</html>